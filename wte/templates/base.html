{% load static %}
{% load django_bootstrap5 %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> {% block title %} Women in Tech & Entrepreneurship {% endblock %}</title>

    {% bootstrap_css %}
    <link rel="stylesheet" href="{% static 'css/pulse_bootstrap.min.css' %}?v={{ STATIC_VERSION }}" id="pulse-theme">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}?v={{ STATIC_VERSION }}">
    {% bootstrap_javascript %}
</head>

<body>
    <main class="page-content">
        {% block content %}
        {% endblock %}
    </main>

    <!-- FLoating Action Button -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const feedbackBtn = document.getElementById('feedbackBtn');
            const modal = document.getElementById('feedbackModal');
            const closeBtn = document.getElementById('closeFeedback');
            const feedbackForm = modal.querySelector('form');
            const submitBtn = modal.querySelector('.feedback-submit');

            feedbackBtn.addEventListener('click', () => {
                modal.style.display = 'block';
            });

            closeBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });

            window.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });

            // AJAX Form Submission
            feedbackForm.addEventListener('submit', function (e) {
                e.preventDefault();

                const formData = new FormData(feedbackForm);
                submitBtn.textContent = 'Sending...';
                submitBtn.disabled = true;

                fetch("{% url 'submit_feedback' %}", {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest',
                    }
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            // Show success message and close modal
                            modal.innerHTML = `
                    <div style="padding: 40px; text-align: center; color: white;">
                        <h3>Feedback Sent Successfully!</h3>
                        <p>Thank you for your feedback! Our team has been notified. ðŸŽ‰</p>
                        <button onclick="location.reload()" style="background: #593196; color: white; border: none; padding: 12px 24px; border-radius: 12px; font-size: 1rem; cursor: pointer; margin-top: 20px;">Done</button>
                    </div>
                `;
                        } else {
                            alert('Error: ' + (data.error || 'Something went wrong'));
                            submitBtn.textContent = 'Send Feedback';
                            submitBtn.disabled = false;
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('Network error. Please try again.');
                        submitBtn.textContent = 'Send Feedback';
                        submitBtn.disabled = false;
                    });
            });
        });
    </script>

</body>

</html>