{% extends "base.html" %}

<!-- This is the user homepage. In other words, the landing page -->

{% block title %} Home {% endblock %}

{% block content %}
{% include 'dashboard/navbar.html' %}
<div class="main-with-sidebar">
  {% if user.is_authenticated %}
  <div class="dashboard-container">
    <!-- Main Content -->
    <section class="main-content">
      <!-- Welcome Section -->
      <section class="welcome-section">
        <div class="container-fluid">
          <div class="row">
            <div class="col">
              <h1 class="display-4">Hi {{ user.first_name }}!</h1>
            </div>
          </div>
        </div>
      </section>

      <!-- Bottom Sections -->
      <section class="bottom-sections">
        <div class="container-fluid">
          <div class="row">
            <!-- Rewards Section -->
            <div class="col">
              <div class="card">
                <div class="card-header">
                  <h2>Rewards Earned</h2>
                </div>
                <div class="card-body">
                  <!-- Rewards content will go here -->
                  <!-- TODO rewards tabulation -->
                </div>
              </div>
            </div>

            <!-- Events Section -->
            <div class="col">
              <div class="card">
                <div class="card-header">
                  <h2>
                    Events Attended
                    <a class="add-event-container" href="{% url 'community' %}">
                      Add Event
                    </a>
                  </h2>
                </div>
                <div class="card-body">
                  <table class="table table-striped">
                    <thead>
                      <tr>
                        <th>Event Name</th>
                        <th>Event Date</th>
                        <th>Event Organizer</th>
                        <th>Points Awarded</th>
                      </tr>
                    </thead>

                    <tbody>
                      {% for event in user.attended_events.all %}
                      <tr>
                        <td>{{ event.event_name }}</td>
                        <td>{{ event.event_date|date:"F j, Y" }}</td>
                        <td>{{ event.event_organizer }}</td>
                        <td>
                          {% if event.activity_type == "event_external" %}
                          8
                          {% else %}
                          10
                          {% endif %}
                        </td>
                      </tr>
                      {% empty %}
                      <tr>
                        <td colspan="4">No events yet.</td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>


                </div>
              </div>
            </div>
          </div>
      </section>
    </section>
  </div>

  {% else %}
  {% include 'registration/login.html' %}
  {% endif %}
</div>
{% endblock %}